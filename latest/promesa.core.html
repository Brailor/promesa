<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>promesa.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Promesa</span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="promises.html"><div class="inner"><span>Working with Promises</span></div></a></li><li class="depth-1 "><a href="executors.html"><div class="inner"><span>Scheduling &amp; Executors</span></div></a></li><li class="depth-1 "><a href="channels.html"><div class="inner"><span>Channels (CSP pattern)</span></div></a></li><li class="depth-1 "><a href="bulkhead.html"><div class="inner"><span>Bulkhead (concurrency limiter)</span></div></a></li><li class="depth-1 "><a href="contributing.html"><div class="inner"><span>Contributing</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>promesa</span></div></div></li><li class="depth-2 branch current"><a href="promesa.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="promesa.exec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exec</span></div></a></li><li class="depth-3 branch"><a href="promesa.exec.bulkhead.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bulkhead</span></div></a></li><li class="depth-3"><a href="promesa.exec.csp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>csp</span></div></a></li><li class="depth-2"><a href="promesa.protocols.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>protocols</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="promesa.core.html#var--.3E"><div class="inner"><span>-&gt;</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var--.3E.3E"><div class="inner"><span>-&gt;&gt;</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-all"><div class="inner"><span>all</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-any"><div class="inner"><span>any</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-as-.3E"><div class="inner"><span>as-&gt;</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-await"><div class="inner"><span>await</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-await.21"><div class="inner"><span>await!</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-bind"><div class="inner"><span>bind</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-cancel.21"><div class="inner"><span>cancel!</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-cancelled.3F"><div class="inner"><span>cancelled?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-catch"><div class="inner"><span>catch</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-chain"><div class="inner"><span>chain</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-chain.27"><div class="inner"><span>chain'</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-deferred"><div class="inner"><span>deferred</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-deferred.3F"><div class="inner"><span>deferred?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-delay"><div class="inner"><span>delay</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-do"><div class="inner"><span>do</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-do.21"><div class="inner"><span>do!</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-do*"><div class="inner"><span>do*</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-done.3F"><div class="inner"><span>done?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-doseq"><div class="inner"><span>doseq</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-extract"><div class="inner"><span>extract</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-finally"><div class="inner"><span>finally</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-fmap"><div class="inner"><span>fmap</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-fnly"><div class="inner"><span>fnly</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-future"><div class="inner"><span>future</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-handle"><div class="inner"><span>handle</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-hcat"><div class="inner"><span>hcat</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-hmap"><div class="inner"><span>hmap</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-let"><div class="inner"><span>let</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-let*"><div class="inner"><span>let*</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-loop"><div class="inner"><span>loop</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-map"><div class="inner"><span>map</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-mapcat"><div class="inner"><span>mapcat</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-mcat"><div class="inner"><span>mcat</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-merr"><div class="inner"><span>merr</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-pending.3F"><div class="inner"><span>pending?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-plet"><div class="inner"><span>plet</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-promise"><div class="inner"><span>promise</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-promise.3F"><div class="inner"><span>promise?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-promisify"><div class="inner"><span>promisify</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-race"><div class="inner"><span>race</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-recur"><div class="inner"><span>recur</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-recur.3F"><div class="inner"><span>recur?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-reject.21"><div class="inner"><span>reject!</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-rejected"><div class="inner"><span>rejected</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-rejected.3F"><div class="inner"><span>rejected?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-resolve.21"><div class="inner"><span>resolve!</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-resolved"><div class="inner"><span>resolved</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-resolved.3F"><div class="inner"><span>resolved?</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-run.21"><div class="inner"><span>run!</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-then"><div class="inner"><span>then</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-then.27"><div class="inner"><span>then'</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-thread"><div class="inner"><span>thread</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-thread-call"><div class="inner"><span>thread-call</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-timeout"><div class="inner"><span>timeout</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-vthread"><div class="inner"><span>vthread</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-vthread-call"><div class="inner"><span>vthread-call</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-wait-all"><div class="inner"><span>wait-all</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-with-redefs"><div class="inner"><span>with-redefs</span></div></a></li><li class="depth-1"><a href="promesa.core.html#var-wrap"><div class="inner"><span>wrap</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">promesa.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var--.3E"><h3>-&gt;</h3><h4 class="type">macro</h4><div class="usage"><code>(-&gt; x &amp; forms)</code></div><div class="doc"><div class="markdown"><p>Like the clojure.core/-&gt;, but it will handle promises in values and make sure the next form gets the value realized instead of the promise.</p>
<p>Example fetching data in the browser with CLJS:</p>
<p>(p/-&gt; (js/fetch #js {…}) ; returns a promise .-body)</p>
<p>The result of a thread is a promise that will resolve to the end of the thread chain.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L648">view source</a></div></div><div class="public anchor" id="var--.3E.3E"><h3>-&gt;&gt;</h3><h4 class="type">macro</h4><div class="usage"><code>(-&gt;&gt; x &amp; forms)</code></div><div class="doc"><div class="markdown"><p>Like the clojure.core/-&gt;&gt;, but it will handle promises in values and make sure the next form gets the value realized instead of the promise.</p>
<p>Example fetching data in the browser with CLJS:</p>
<p>(p/-&gt;&gt; (js/fetch #js {…}) ; returns a promise .-body read-string (mapv inc)</p>
<p>The result of a thread is a promise that will resolve to the end of the thread chain.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L668">view source</a></div></div><div class="public anchor" id="var-all"><h3>all</h3><div class="usage"><code>(all promises)</code></div><div class="doc"><div class="markdown"><p>Given an array of promises, return a promise that is fulfilled when all the items in the array are fulfilled.</p>
<p>Example:</p>
<pre><code>(-&gt; (p/all [(promise :first-promise)
            (promise :second-promise)])
    (then (fn [[first-result second-result]])
            (println (str first-result ", " second-result))))
</code></pre>
<p>Will print to out <code>:first-promise, :second-promise</code>.</p>
<p>If at least one of the promises is rejected, the resulting promise will be rejected.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L347">view source</a></div></div><div class="public anchor" id="var-any"><h3>any</h3><div class="usage"><code>(any promises)</code><code>(any promises default)</code></div><div class="doc"><div class="markdown"><p>Given an array of promises, return a promise that is fulfilled when first one item in the array is fulfilled.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L393">view source</a></div></div><div class="public anchor" id="var-as-.3E"><h3>as-&gt;</h3><h4 class="type">macro</h4><div class="usage"><code>(as-&gt; expr name &amp; forms)</code></div><div class="doc"><div class="markdown"><p>Like clojure.core/as-&gt;, but it will handle promises in values and make sure the next form gets the value realized instead of the promise.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L690">view source</a></div></div><div class="public anchor" id="var-await"><h3>await</h3><div class="usage"><code>(await resource)</code><code>(await resource duration)</code></div><div class="doc"><div class="markdown"><p>A exception safer variant of <code>await!</code>. Returns <code>nil</code> on timeout exception, forwards interrupted exception and all other exceptions are returned as value, so user is responsible for checking if the returned value is exception or not.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L750">view source</a></div></div><div class="public anchor" id="var-await.21"><h3>await!</h3><div class="usage"><code>(await! resource)</code><code>(await! resource duration)</code></div><div class="doc"><div class="markdown"><p>Generic await operation. Block current thread until some operation terminates. Returns <code>nil</code> on timeout; does not catch any other exception.</p>
<p>Default implementation for Thread, CompletableFuture and CountDownLatch.</p>
<p>The return value is implementation specific.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L732">view source</a></div></div><div class="public anchor" id="var-bind"><h3>bind</h3><div class="usage"><code>(bind p f)</code><code>(bind p f executor)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed with when the promise <code>p</code> is successfully resolved. Returns a promise that will mirror the promise instance returned by calling <code>f</code> with the value as single argument; <code>f</code> <strong>must</strong> return a promise instance.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L163">view source</a></div></div><div class="public anchor" id="var-cancel.21"><h3>cancel!</h3><div class="usage"><code>(cancel! p)</code></div><div class="doc"><div class="markdown"><p>Cancel the promise.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L442">view source</a></div></div><div class="public anchor" id="var-cancelled.3F"><h3>cancelled?</h3><div class="usage"><code>(cancelled? v)</code></div><div class="doc"><div class="markdown"><p>Return true if <code>v</code> is a cancelled promise.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L448">view source</a></div></div><div class="public anchor" id="var-catch"><h3>catch</h3><div class="usage"><code>(catch p f)</code><code>(catch p pred-or-type f)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is rejected. Returns a promise that will be resolved with the return value of calling <code>f</code> with exception as single argument; <code>f</code> can return a plain value or promise instance, an automatic unwrapping will be performed.</p>
<p>The computation will be executed in the completion thread, look at <code>merr</code> if you want the ability to schedule the computation to other thread.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L301">view source</a></div></div><div class="public anchor" id="var-chain"><h3>chain</h3><div class="usage"><code>(chain p f)</code><code>(chain p f &amp; fs)</code></div><div class="doc"><div class="markdown"><p>Chain variable number of functions to be executed serially using <code>then</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L219">view source</a></div></div><div class="public anchor" id="var-chain.27"><h3>chain'</h3><div class="usage"><code>(chain' p f)</code><code>(chain' p f &amp; fs)</code></div><div class="doc"><div class="markdown"><p>Chain variable number of functions to be executed serially using <code>map</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L225">view source</a></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create f)</code><code>(create f executor)</code></div><div class="doc"><div class="markdown"><p>Create a promise instance from a factory function. If an executor is provided, the factory will be executed in the provided executor.</p>
<p>A factory function looks like <code>(fn [resolve reject] (resolve 1))</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L62">view source</a></div></div><div class="public anchor" id="var-deferred"><h3>deferred</h3><div class="usage"><code>(deferred)</code></div><div class="doc"><div class="markdown"><p>Creates an empty promise instance.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L40">view source</a></div></div><div class="public anchor" id="var-deferred.3F"><h3>deferred?</h3><div class="usage"><code>(deferred? v)</code></div><div class="doc"><div class="markdown"><p>Return true if <code>v</code> is a promise instance (alias to <code>promise?</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L90">view source</a></div></div><div class="public anchor" id="var-delay"><h3>delay</h3><div class="usage"><code>(delay t)</code><code>(delay t v)</code><code>(delay t v scheduler)</code></div><div class="doc"><div class="markdown"><p>Given a timeout in miliseconds and optional value, returns a promise that will be fulfilled with provided value (or nil) after the time is reached.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L504">view source</a></div></div><div class="public anchor" id="var-do"><h3>do</h3><h4 class="type">macro</h4><div class="usage"><code>(do &amp; exprs)</code></div><div class="doc"><div class="markdown"><p>Execute potentially side effectful code and return a promise resolved to the last expression after awaiting the result of each expression.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L527">view source</a></div></div><div class="public anchor" id="var-do.21"><h3>do!</h3><h4 class="type">macro</h4><div class="usage"><code>(do! &amp; exprs)</code></div><div class="doc"><div class="markdown"><p>A convenience alias for <code>do</code> macro.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L537">view source</a></div></div><div class="public anchor" id="var-do*"><h3>do*</h3><h4 class="type">macro</h4><div class="usage"><code>(do* &amp; exprs)</code></div><div class="doc"><div class="markdown"><p>An exception unsafe do-like macro. Supposes that we are already wrapped in promise context so avoids defensive wrapping.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L515">view source</a></div></div><div class="public anchor" id="var-done.3F"><h3>done?</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Returns true if promise <code>p</code> is already done.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L129">view source</a></div></div><div class="public anchor" id="var-doseq"><h3>doseq</h3><h4 class="type">macro</h4><div class="usage"><code>(doseq [binding xs] &amp; body)</code></div><div class="doc"><div class="markdown"><p>Simplified version of <code>doseq</code> which takes one binding and a seq, and runs over it using <code>promesa.core/run!</code></p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L723">view source</a></div></div><div class="public anchor" id="var-extract"><h3>extract</h3><div class="usage"><code>(extract p)</code></div><div class="doc"><div class="markdown"><p>Returns the current promise value.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L123">view source</a></div></div><div class="public anchor" id="var-finally"><h3>finally</h3><div class="usage"><code>(finally p f)</code><code>(finally p f executor)</code></div><div class="doc"><div class="markdown"><p>Like <code>handle</code> but ignores the return value. Returns a promise that will mirror the original one.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L251">view source</a></div></div><div class="public anchor" id="var-fmap"><h3>fmap</h3><div class="usage"><code>(fmap f p)</code><code>(fmap executor f p)</code></div><div class="doc"><div class="markdown"><p>A convenience alias for <code>map</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L190">view source</a></div></div><div class="public anchor" id="var-fnly"><h3>fnly</h3><div class="usage"><code>(fnly f p)</code><code>(fnly executor f p)</code></div><div class="doc"><div class="markdown"><p>Inverted arguments version of <code>finally</code>; intended to be used with <code>-&gt;&gt;</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L293">view source</a></div></div><div class="public anchor" id="var-future"><h3>future</h3><h4 class="type">macro</h4><div class="usage"><code>(future &amp; body)</code></div><div class="doc"><div class="markdown"><p>Analogous macro to <code>clojure.core/future</code> that returns promise instance instead of the <code>Future</code>. Exposed just for convenience and works as an alias to <code>thread</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L598">view source</a></div></div><div class="public anchor" id="var-handle"><h3>handle</h3><div class="usage"><code>(handle p f)</code><code>(handle p f executor)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is completed (resolved or rejected) and returns a promise completed (resolving or rejecting) with the return value of calling <code>f</code> with both: value and the exception; <code>f</code> can return a new plain value or promise instance, and automatic unwrapping will be performed.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
<p>For performance sensitive code, look at <code>hmap</code> and <code>hcat</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L231">view source</a></div></div><div class="public anchor" id="var-hcat"><h3>hcat</h3><div class="usage"><code>(hcat f p)</code><code>(hcat executor f p)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is completed (resolved or rejected) and returns a promise that will mirror the promise instance returned by calling <code>f</code> with both: value and the exception.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
<p>Intended to be used with <code>-&gt;&gt;</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L274">view source</a></div></div><div class="public anchor" id="var-hmap"><h3>hmap</h3><div class="usage"><code>(hmap f p)</code><code>(hmap executor f p)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is completed (resolved or rejected) and returns a promise completed (resolving or rejecting) with the return value of calling <code>f</code> with both: value and the exception.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
<p>Intended to be used with <code>-&gt;&gt;</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L259">view source</a></div></div><div class="public anchor" id="var-let"><h3>let</h3><h4 class="type">macro</h4><div class="usage"><code>(let bindings &amp; body)</code></div><div class="doc"><div class="markdown"><p>A <code>let</code> alternative that always returns promise and waits for all the promises on the bindings.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L551">view source</a></div></div><div class="public anchor" id="var-let*"><h3>let*</h3><h4 class="type">macro</h4><div class="usage"><code>(let* bindings &amp; body)</code></div><div class="doc"><div class="markdown"><p>An exception unsafe let-like macro. Supposes that we are already wrapped in promise context so avoids defensive wrapping.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L542">view source</a></div></div><div class="public anchor" id="var-loop"><h3>loop</h3><h4 class="type">macro</h4><div class="usage"><code>(loop bindings &amp; body)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L610">view source</a></div></div><div class="public anchor" id="var-map"><h3>map</h3><div class="usage"><code>(map f p)</code><code>(map executor f p)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is successfully resolved. Returns a promise that will be resolved with the return value of calling <code>f</code> with value as single argument.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
<p>This function is intended to be used with <code>-&gt;&gt;</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L176">view source</a></div></div><div class="public anchor" id="var-mapcat"><h3>mapcat</h3><div class="usage"><code>(mapcat f p)</code><code>(mapcat executor f p)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is successfully resolved. Returns a promise that will mirror the promise instance returned by calling <code>f</code> with the value as single argument; <code>f</code> <strong>must</strong> return a promise instance.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
<p>This funciton is intended to be used with <code>-&gt;&gt;</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L197">view source</a></div></div><div class="public anchor" id="var-mcat"><h3>mcat</h3><div class="usage"><code>(mcat f p)</code><code>(mcat executor f p)</code></div><div class="doc"><div class="markdown"><p>A convenience alias for <code>mapcat</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L212">view source</a></div></div><div class="public anchor" id="var-merr"><h3>merr</h3><div class="usage"><code>(merr f p)</code><code>(merr executor f p)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is rejected. Returns a promise that will mirror the promise returned by calling <code>f</code> with exception as single argument; <code>f</code> <strong>must</strong> return a promise instance.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
<p>This is intended to be used with <code>-&gt;&gt;</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L334">view source</a></div></div><div class="public anchor" id="var-pending.3F"><h3>pending?</h3><div class="usage"><code>(pending? p)</code></div><div class="doc"><div class="markdown"><p>Returns true if promise <code>p</code> is stil pending.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L117">view source</a></div></div><div class="public anchor" id="var-plet"><h3>plet</h3><h4 class="type">macro</h4><div class="usage"><code>(plet bindings &amp; body)</code></div><div class="doc"><div class="markdown"><p>A parallel let; executes all the bindings in parallel and when all bindings are resolved, executes the body.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L561">view source</a></div></div><div class="public anchor" id="var-promise"><h3>promise</h3><div class="usage"><code>(promise v)</code><code>(promise v executor)</code></div><div class="doc"><div class="markdown"><p>The coerce based promise constructor. Creates an appropriate promise instance depending on the provided value.</p>
<p>If an executor is provided, it will be used to resolve this promise.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L45">view source</a></div></div><div class="public anchor" id="var-promise.3F"><h3>promise?</h3><div class="usage"><code>(promise? v)</code></div><div class="doc"><div class="markdown"><p>Return true if <code>v</code> is a promise instance.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L85">view source</a></div></div><div class="public anchor" id="var-promisify"><h3>promisify</h3><div class="usage"><code>(promisify callable)</code></div><div class="doc"><div class="markdown"><p>Given a function that accepts a callback as the last argument, return a function that returns a promise. Callback is expected to take one parameter (result of a computation).</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L467">view source</a></div></div><div class="public anchor" id="var-race"><h3>race</h3><div class="usage"><code>(race promises)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L388">view source</a></div></div><div class="public anchor" id="var-recur"><h3>recur</h3><h4 class="type">macro</h4><div class="usage"><code>(recur &amp; args)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L644">view source</a></div></div><div class="public anchor" id="var-recur.3F"><h3>recur?</h3><div class="usage"><code>(recur? o)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L606">view source</a></div></div><div class="public anchor" id="var-reject.21"><h3>reject!</h3><div class="usage"><code>(reject! p e)</code></div><div class="doc"><div class="markdown"><p>Reject a completable promise with an error.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L460">view source</a></div></div><div class="public anchor" id="var-rejected"><h3>rejected</h3><div class="usage"><code>(rejected v)</code></div><div class="doc"><div class="markdown"><p>Return a rejected promise with provided reason.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L35">view source</a></div></div><div class="public anchor" id="var-rejected.3F"><h3>rejected?</h3><div class="usage"><code>(rejected? p)</code></div><div class="doc"><div class="markdown"><p>Returns true if promise <code>p</code> is already rejected.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L111">view source</a></div></div><div class="public anchor" id="var-resolve.21"><h3>resolve!</h3><div class="usage"><code>(resolve! o)</code><code>(resolve! o v)</code></div><div class="doc"><div class="markdown"><p>Resolve a completable promise with a value.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L455">view source</a></div></div><div class="public anchor" id="var-resolved"><h3>resolved</h3><div class="usage"><code>(resolved v)</code></div><div class="doc"><div class="markdown"><p>Return a resolved promise with provided value.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L30">view source</a></div></div><div class="public anchor" id="var-resolved.3F"><h3>resolved?</h3><div class="usage"><code>(resolved? p)</code></div><div class="doc"><div class="markdown"><p>Returns true if promise <code>p</code> is already fulfilled.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L105">view source</a></div></div><div class="public anchor" id="var-run.21"><h3>run!</h3><div class="usage"><code>(run! f coll)</code><code>(run! f coll executor)</code></div><div class="doc"><div class="markdown"><p>A promise aware run! function. Executed in terms of <code>then</code> rules.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L435">view source</a></div></div><div class="public anchor" id="var-then"><h3>then</h3><div class="usage"><code>(then p f)</code><code>(then p f executor)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is successfully resolved. Returns a promise that will be resolved with the return value of calling <code>f</code> with value as single argument; <code>f</code> can return a plain value or promise instance, an automatic unwrapping will be performed.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L135">view source</a></div></div><div class="public anchor" id="var-then.27"><h3>then'</h3><div class="usage"><code>(then' p f)</code><code>(then' p f executor)</code></div><div class="doc"><div class="markdown"><p>Chains a function <code>f</code> to be executed when the promise <code>p</code> is successfully resolved. Returns a promise that will be resolved with the return value of calling <code>f</code> with value as single argument; <code>f</code> should return a plain value, no automatic unwrapping will be performed.</p>
<p>The computation will be executed in the completion thread by default; you also can provide a custom executor.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L149">view source</a></div></div><div class="public anchor" id="var-thread"><h3>thread</h3><h4 class="type">macro</h4><div class="usage"><code>(thread &amp; body)</code></div><div class="doc"><div class="markdown"><p>Analogous to <code>clojure.core.async/thread</code> that returns a promise instance instead of the <code>Future</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L585">view source</a></div></div><div class="public anchor" id="var-thread-call"><h3>thread-call</h3><div class="usage"><code>(thread-call f)</code><code>(thread-call executor f)</code></div><div class="doc"><div class="markdown"><p>Analogous to <code>clojure.core.async/thread</code> that returns a promise instance instead of the <code>Future</code>. Useful for executing synchronous code in a separate thread (also works in cljs).</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L573">view source</a></div></div><div class="public anchor" id="var-timeout"><h3>timeout</h3><div class="usage"><code>(timeout p t)</code><code>(timeout p t v)</code><code>(timeout p t v scheduler)</code></div><div class="doc"><div class="markdown"><p>Returns a cancellable promise that will be fulfilled with this promise’s fulfillment value or rejection reason.  However, if this promise is not fulfilled or rejected within <code>ms</code> milliseconds, the returned promise is cancelled with a TimeoutError.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L490">view source</a></div></div><div class="public anchor" id="var-vthread"><h3>vthread</h3><h4 class="type">macro</h4><div class="usage"><code>(vthread &amp; body)</code></div><div class="doc"><div class="markdown"><p>Analogous to <code>clojure.core.async/thread</code> that returns a promise instance instead of the <code>Future</code>. Useful for executing synchronous code in a separate thread (also works in cljs).</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L591">view source</a></div></div><div class="public anchor" id="var-vthread-call"><h3>vthread-call</h3><div class="usage"><code>(vthread-call f)</code></div><div class="doc"><div class="markdown"><p>A shortcut for <code>(p/thread-call :vthread f)</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L580">view source</a></div></div><div class="public anchor" id="var-wait-all"><h3>wait-all</h3><div class="usage"><code>(wait-all &amp; promises)</code></div><div class="doc"><div class="markdown"><p>Given a variable number of promises, returns a promise which resolves to <code>nil</code> when all provided promises complete (rejected or resolved).</p>
<p><strong>EXPERIMENTAL</strong></p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L372">view source</a></div></div><div class="public anchor" id="var-with-redefs"><h3>with-redefs</h3><h4 class="type">macro</h4><div class="usage"><code>(with-redefs bindings &amp; body)</code></div><div class="doc"><div class="markdown"><p>Like clojure.core/with-redefs, but it will handle promises in body and wait until they resolve or reject before restoring the bindings. Useful for mocking async APIs.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L701">view source</a></div></div><div class="public anchor" id="var-wrap"><h3>wrap</h3><div class="usage"><code>(wrap v)</code></div><div class="doc"><div class="markdown"><p>A convenience alias for <code>promise</code> coercion function that only accepts a single argument.</p>
</div></div><div class="src-link"><a href="https://github.com/funcool/promesa/blob/master/src/promesa/core.cljc#L56">view source</a></div></div></div></body></html>